{"ast":null,"code":"// Firebase App (the core Firebase SDK) is always required and\n// must be listed before other Firebase SDKs\nimport * as firebase from \"firebase/app\"; // Add the Firebase services that you want to use\n\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\nconst config = {\n  apiKey: \"AIzaSyBLqD6MfNBVj0EHI6KhtbaXogcBDWKdJd4\",\n  authDomain: \"e-shop-db-59460.firebaseapp.com\",\n  databaseURL: \"https://e-shop-db-59460.firebaseio.com\",\n  projectId: \"e-shop-db-59460\",\n  storageBucket: \"e-shop-db-59460.appspot.com\",\n  messagingSenderId: \"197196638417\",\n  appId: \"1:197196638417:web:7807cbfd7dc07f43af3df0\",\n  measurementId: \"G-NWKQG71CLY\"\n};\nexport const createUserProfileDocument = async (userAuth, additionalData) => {\n  if (!userAuth) return;\n  console.log(\"iam userAuth\", userAuth);\n  const userRef = firestore.doc(`users/${userAuth.uid}`);\n  const snapshot = await userRef.get();\n\n  if (!snapshot.exists) {\n    const {\n      displayName,\n      email\n    } = userAuth;\n    const createdAt = new Date();\n\n    try {\n      await userRef.set({\n        displayName,\n        email,\n        createdAt,\n        ...additionalData\n      });\n    } catch (err) {\n      console.log(\"error creating user\", err.message);\n    }\n  }\n\n  console.log(\"iam userRef\", userRef);\n  return userRef;\n};\nexport const addCollectionAndDocuments = async (collectionKey, objectToAdd) => {\n  const collectionRef = firestore.collection(collectionKey); // console.log(\"I am collection\", collectionRef);\n  //in order to save shop data in firebase we need to use batch function, because we can make one query at time and if server breaks we dont want to be able save half\n  //of the data we have. We want to save all or none.\n\n  const batch = firestore.batch();\n  objectToAdd.forEach(obj => {\n    //we want to get the document at an empty string(give me a new document reference in the collection and randomly generate an ID for me)\n    //if we do const newDocRef = collectionRef.doc(obj.title); it will create docs with ID same as title(mens, womens,hats etc..)\n    const newDocRef = collectionRef.doc(); // console.log(newDocRef);\n\n    batch.set(newDocRef, obj);\n  }); //fire off batch request, but it returns a promise when commit succeds it will come back and resolve a void value meaning a null value and that's useful for us\n  //because if call this function somewhere we can chain off this function and then call dot then and do something\n\n  return await batch.commit();\n};\nexport const convertCollectionSnapshotToMap = collections => {\n  const transformedCollection = collections.docs.map(doc => {\n    const {\n      title,\n      items\n    } = doc.data();\n    return {\n      routeName: encodeURI(title.toLowerCase()),\n      id: doc.id,\n      title,\n      items\n    };\n  }); // console.log(transformedCollection);\n\n  return transformedCollection.reduce((acc, collection) => {\n    acc[collection.title.toLowerCase()] = collection;\n    return acc;\n  }, {});\n};\nexport const getCurrentUser = () => {\n  return new Promise((resolve, reject) => {\n    const unsubscribe = auth.onAuthStateChanged(userAuth => {\n      unsubscribe();\n      resolve(userAuth);\n    }, reject);\n  });\n};\nfirebase.initializeApp(config);\nexport const auth = firebase.auth();\nexport const firestore = firebase.firestore();\nexport const googleProvider = new firebase.auth.GoogleAuthProvider();\ngoogleProvider.setCustomParameters({\n  prompt: \"select_account\"\n}); //auth.signInWithPopup(provider);\n\nexport const signInWithGoogle = () => auth.signInWithPopup(googleProvider); //or\n// export const signInWithGoogle = () =>\n//   firebase\n//     .auth()\n//     .signInWithPopup(provider)\n//     .then(function (result) {\n//       // This gives you a Google Access Token. You can use it to access the Google API.\n//       var token = result.credential.accessToken;\n//       // The signed-in user info.\n//       var user = result.user;\n//       // ...\n//     })\n//     .catch(function (error) {\n//       // Handle Errors here.\n//       var errorCode = error.code;\n//       var errorMessage = error.message;\n//       // The email of the user's account used.\n//       var email = error.email;\n//       // The firebase.auth.AuthCredential type that was used.\n//       var credential = error.credential;\n//       // ...\n//     });\n\nexport default firebase;","map":{"version":3,"sources":["/Users/aliyevaparvana/Documents/Udemy/e-online-shop/src/firebase/firebase.utils.js"],"names":["firebase","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","createUserProfileDocument","userAuth","additionalData","console","log","userRef","firestore","doc","uid","snapshot","get","exists","displayName","email","createdAt","Date","set","err","message","addCollectionAndDocuments","collectionKey","objectToAdd","collectionRef","collection","batch","forEach","obj","newDocRef","commit","convertCollectionSnapshotToMap","collections","transformedCollection","docs","map","title","items","data","routeName","encodeURI","toLowerCase","id","reduce","acc","getCurrentUser","Promise","resolve","reject","unsubscribe","auth","onAuthStateChanged","initializeApp","googleProvider","GoogleAuthProvider","setCustomParameters","prompt","signInWithGoogle","signInWithPopup"],"mappings":"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","sourcesContent":["// Firebase App (the core Firebase SDK) is always required and\n// must be listed before other Firebase SDKs\nimport * as firebase from \"firebase/app\";\n\n// Add the Firebase services that you want to use\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\n\nconst config = {\n  apiKey: \"AIzaSyBLqD6MfNBVj0EHI6KhtbaXogcBDWKdJd4\",\n  authDomain: \"e-shop-db-59460.firebaseapp.com\",\n  databaseURL: \"https://e-shop-db-59460.firebaseio.com\",\n  projectId: \"e-shop-db-59460\",\n  storageBucket: \"e-shop-db-59460.appspot.com\",\n  messagingSenderId: \"197196638417\",\n  appId: \"1:197196638417:web:7807cbfd7dc07f43af3df0\",\n  measurementId: \"G-NWKQG71CLY\",\n};\n\nexport const createUserProfileDocument = async (userAuth, additionalData) => {\n  if (!userAuth) return;\n  console.log(\"iam userAuth\", userAuth);\n  const userRef = firestore.doc(`users/${userAuth.uid}`);\n  const snapshot = await userRef.get();\n  if (!snapshot.exists) {\n    const { displayName, email } = userAuth;\n    const createdAt = new Date();\n    try {\n      await userRef.set({\n        displayName,\n        email,\n        createdAt,\n        ...additionalData,\n      });\n    } catch (err) {\n      console.log(\"error creating user\", err.message);\n    }\n  }\n  console.log(\"iam userRef\", userRef);\n  return userRef;\n};\n\nexport const addCollectionAndDocuments = async (collectionKey, objectToAdd) => {\n  const collectionRef = firestore.collection(collectionKey);\n  // console.log(\"I am collection\", collectionRef);\n\n  //in order to save shop data in firebase we need to use batch function, because we can make one query at time and if server breaks we dont want to be able save half\n  //of the data we have. We want to save all or none.\n  const batch = firestore.batch();\n  objectToAdd.forEach((obj) => {\n    //we want to get the document at an empty string(give me a new document reference in the collection and randomly generate an ID for me)\n    //if we do const newDocRef = collectionRef.doc(obj.title); it will create docs with ID same as title(mens, womens,hats etc..)\n    const newDocRef = collectionRef.doc();\n    // console.log(newDocRef);\n    batch.set(newDocRef, obj);\n  });\n  //fire off batch request, but it returns a promise when commit succeds it will come back and resolve a void value meaning a null value and that's useful for us\n  //because if call this function somewhere we can chain off this function and then call dot then and do something\n  return await batch.commit();\n};\n\nexport const convertCollectionSnapshotToMap = (collections) => {\n  const transformedCollection = collections.docs.map((doc) => {\n    const { title, items } = doc.data();\n\n    return {\n      routeName: encodeURI(title.toLowerCase()),\n      id: doc.id,\n      title,\n      items,\n    };\n  });\n  // console.log(transformedCollection);\n  return transformedCollection.reduce((acc, collection) => {\n    acc[collection.title.toLowerCase()] = collection;\n    return acc;\n  }, {});\n};\n\nexport const getCurrentUser = () => {\n  return new Promise((resolve, reject) => {\n    const unsubscribe = auth.onAuthStateChanged((userAuth) => {\n      unsubscribe();\n      resolve(userAuth);\n    }, reject);\n  });\n};\n\nfirebase.initializeApp(config);\n\nexport const auth = firebase.auth();\nexport const firestore = firebase.firestore();\n\nexport const googleProvider = new firebase.auth.GoogleAuthProvider();\ngoogleProvider.setCustomParameters({ prompt: \"select_account\" });\n//auth.signInWithPopup(provider);\nexport const signInWithGoogle = () => auth.signInWithPopup(googleProvider);\n\n//or\n// export const signInWithGoogle = () =>\n//   firebase\n//     .auth()\n//     .signInWithPopup(provider)\n//     .then(function (result) {\n//       // This gives you a Google Access Token. You can use it to access the Google API.\n//       var token = result.credential.accessToken;\n//       // The signed-in user info.\n//       var user = result.user;\n//       // ...\n//     })\n//     .catch(function (error) {\n//       // Handle Errors here.\n//       var errorCode = error.code;\n//       var errorMessage = error.message;\n//       // The email of the user's account used.\n//       var email = error.email;\n//       // The firebase.auth.AuthCredential type that was used.\n//       var credential = error.credential;\n//       // ...\n//     });\n\nexport default firebase;\n"]},"metadata":{},"sourceType":"module"}